Described in https://vasil.ludost.net/blog/?p=2909.
